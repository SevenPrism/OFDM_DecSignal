len=50000;

for n=1:len
    x=ofdm_signal();
    xa=abs(x);
    p(n)=10*log10(max(xa).^2/(mean(xa.^2)));%%PAPRµÄ¼ÆËã
end

pow=mean(xa.^2);

[papr,prob]=ccdf1(p,len);
f1=(1-exp(-1/pow));
f2=(exp(-1/pow)-exp(-2/pow));
f3=exp(-2/pow);
p1=pow-(1+pow)*exp(-1/pow);
p2=(1+pow)*exp(-1/pow)-(2+pow)*exp(-2/pow);
p3=(2+pow)*exp(-2/pow);

papr1=10*log10(3*(p1+p2/2+p3/3)/pow);
papr2=10*log10(3*(p2/2+p3/3)/((f2+f3)*pow));
papr3=10*log10(p3/(f3*pow));
%prob1= [1 1	1 1	1 1	1 1 1 1 1 0.9809 0.95742 0.9325 0.86172 0.65288 0.41188 0.22256 0.10536 0.04552 0.01704 0.006 0.00186 0.00062 0.00018 2.0e-05 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
%ofdmpr=[-3.84355474610437,-3.34355474610437,-2.84355474610437,-2.34355474610437,-1.84355474610437,-1.34355474610437,-0.843554746104370,-0.343554746104370,0.156445253895630,0.656445253895630,1.15644525389563,1.65644525389563,2.15644525389563,2.65644525389563,3.95644525389563,4.95644525389563,5.65644525389563,6.25644525389563,7.65644525389563,8.35644525389563,9.95644525389563,10.75644525389563,11.75644525389563,12.95644525389563,13.15644525389563,13.65644525389563,14.15644525389563,15.65644525389563,16.1564452538956,16.6564452538956,17.1564452538956,17.6564452538956,18.1564452538956,18.6564452538956,19.1564452538956,19.6564452538956,20.1564452538956,20.6564452538956,21.1564452538956,21.6564452538956,22.1564452538956];

figure(1)
hold on
%semilogy(papr-papr1-0.1+3,prob,'o')
semilogy(papr-papr1,prob,'o')
hold on
%semilogy(papr-papr2+3,prob,'*')
semilogy(papr-papr2,prob,'*')
hold on
semilogy(papr-papr3,prob,'s')
hold on 
%semilogy(ofdmpr+3,prob1,'d')
semilogy(papr,prob,'d')

% hold on 
% semilogy(papr-papr1,prob1,'x')
axis([0,20,10^(-4),1]);

% figure(2)
% hold on 
% plot(papr-papr1-0.1,prob,'o')
% hold on
% plot(papr-papr2-0.1,prob,'*')